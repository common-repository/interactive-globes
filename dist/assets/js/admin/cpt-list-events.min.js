function refresh_cpt_list(t,e){get_cpt_list(t,e).then(e=>{var o=document.getElementById("fill_"+t);return!!o&&(o.innerHTML=e,init_cpt_events(t),ittGlobesAdmin.onChange(),!0)})}async function get_cpt_list(t,e){try{const o=itt_globe_rest.namespace+e+"/"+t+itt_globe_rest.list_part,n=await fetch(o,{method:"GET",headers:{"Content-Type":"application/json","X-WP-Nonce":itt_globe_rest.nonce}});if(!n.ok)throw new Error("Network response was not OK");return await n.json()}catch(t){console.error("There has been a problem with your fetch operation:",t)}}function init_cpt_events(t){let e="#block_"+t,o=document.querySelector(e);o&&(o.querySelectorAll(".js-remove-cpt").forEach((function(t){t.addEventListener("click",do_remove_event)})),o.querySelectorAll(".js-modal-edit-cpt").forEach((function(t){t.addEventListener("click",(function(t){let e=[];for(const t in this.dataset)this.dataset.hasOwnProperty(t)&&e.push([t,this.dataset[t]]);const o=this.getAttribute("data-cpt_post_id"),n=this.getAttribute("data-parent_id");editEntry(this.getAttribute("data-post_type"),o,n,e)}))})),o.querySelectorAll(".js-modal-add-new-cpt").forEach((function(t){t.addEventListener("click",(function(t){t.preventDefault();const e=this.getAttribute("data-parent_id"),o=this.getAttribute("data-post_type");let n=[];for(const t in this.dataset)this.dataset.hasOwnProperty(t)&&n.push([t,this.dataset[t]]);addNew(o,e,n)}))})),o.querySelectorAll(".js-modal-close").forEach((function(t){t.addEventListener("click",(function(t){t.preventDefault();closeModal(this.getAttribute("data-post_type"))}))})))}function do_remove_event(t){if(!confirm("Are you sure?"))return;t.preventDefault();const e=this.getAttribute("data-cpt_post_id"),o=this.getAttribute("data-parent_id"),n=this.getAttribute("data-post_type"),r=new XMLHttpRequest;r.open("POST",`/wp-json/wp/v2/${n}/${e}?_method=DELETE`,!0),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("X-WP-Nonce",wpApiSettings.nonce),r.onload=function(){r.status>=200&&r.status<300?(JSON.parse(r.responseText),refresh_cpt_list(n,o)):console.error("Error trashing post:",r.statusText)},r.onerror=function(){console.error("Network error occurred")},r.send()}function editEntry(t,e,o,n){query_params=[["action","edit"],["iframe",""],["post",e],["parent_id",o]].concat(n);const r=build_modal_url(itt_globe_data.admin_url,"post.php",query_params),a=document.querySelector("#"+t+"_modal iframe");a.setAttribute("src",r),a.addEventListener("load",(function(){document.querySelector("#"+t+"_modal .overlay-content-loading").style.display="none",a.style.display="block"})),document.getElementById(t+"_modal").style.display="block"}function addNew(t,e,o){let n=[["iframe",""]].concat(o);const r=build_modal_url(itt_globe_data.admin_url,"post-new.php",n),a=document.querySelector("#"+t+"_modal iframe");a.setAttribute("src",r),a.addEventListener("load",(function(){document.querySelector("#"+t+"_modal .overlay-content-loading").style.display="none",a.style.display="block"})),document.getElementById(t+"_modal").style.display="block"}function closeModal(t){document.getElementById(t+"_modal").style.display="none",document.querySelector("#"+t+"_modal .overlay-content-loading").style.display="block",document.querySelector("#"+t+"_modal iframe").setAttribute("src","")}function build_modal_url(t,e,o){const n=new URLSearchParams;return o.forEach(t=>{if(!Array.isArray(t)||2!==t.length)throw new Error("Each param should be an array with two elements: [key, value]");n.append(t[0],t[1])}),t+e+"?"+n.toString()}window.addEventListener("message",(function(t){if(!t.data.hasOwnProperty("message")||!t.data.hasOwnProperty("params"))return;if("refresh-cpt-list"!==t.data.message)return;const e=t.data.params;(e.hasOwnProperty("post_type")||e.hasOwnProperty("parent_id"))&&refresh_cpt_list(e.post_type,e.parent_id)}));