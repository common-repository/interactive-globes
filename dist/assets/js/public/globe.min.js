function setupTooltip(t){let e="";return t.tooltipContent&&""!==t.tooltipContent&&(e='<div class="itt_globe_tooltip">'+t.tooltipContent+"</div>"),e}const globe_ut_prepareURL=function(t){if("string"!=typeof t)return t;var e;(t=t.replace(/&amp;/gi,"&")).replace(/&#(\d+);/g,(function(t,e){return String.fromCharCode(e)}));try{e=new URL(t)}catch(t){e=!1}return e&&![null,"http:","https:","mailto:","tel:"].includes(e.protocol)?(console.log("URL protocol not allowed"),""):t},globe_ut_prepareData=function(t){t.hasOwnProperty("dotLabels")&&t.dotLabels||(t.dotlabels=[]),t.hasOwnProperty("points")&&t.points||(t.points=[]);let e={showGraticules:!1,backgroundColor:"transparent",atmosphere:{enabled:!1,atmosphereColor:null,atmosphereAltitude:null},globeImage:"earth-day.jpg"};return(0===Object.keys(t).length||t.emptyPreview)&&Object.assign(t,e),t.pointOfView={lat:0,lng:0,altitude:1.5},t.centerCoordinates&&(t.pointOfView.lat=globe_ut_float(t.centerCoordinates.latitude),t.pointOfView.lng=globe_ut_float(t.centerCoordinates.longitude),t.pointOfView.altitude=globe_ut_float(t.altitude)),t},globe_ut_setupData=function(t,e){for(const o in e){let n=e[o];Array.isArray(t[o])&&t[o]&&t[o].map((function(e){(void 0===e.useCustom||void 0!==e.useCustom&&!globe_ut_bool(e.useCustom))&&Object.assign(e,t[n]),e.action&&"default"===e.action&&(e.action=t[n].action)}))}},globe_ut_prepareViewport=function(t,e){var o=t.closest(".itt_globe_aspect_ratio");window.innerWidth<=780&&void 0!==e.paddingTop&&""!==e.paddingTop?o.style.paddingTop=String(e.paddingTopMobile)+"%":o.style.paddingTop=String(e.paddingTop)+"%"},globe_ut_float=function(t){var e=parseFloat(t);return isNaN(e)?0:e},globe_ut_bool=function(t){return 0!==Number(t)&&"false"!==t&&void 0!==t};function setupClickEvent(t,e,o){if("none"===o.action)return;const n=o.action;n&&"function"==typeof window.ittGlobes.clickActions[n]&&window.ittGlobes.clickActions[n](t,e,o),ittGlobeData.isAdmin||("open_url"!==o.action&&"open_url_new"!==o.action||(o.content=globe_ut_prepareURL(o.content)),"open_url"===o.action&&""!==o.content?document.location=o.content:"open_url_new"===o.action&&""!==o.content&&window.open(o.content))}function setupHoverEvent(t,e,o){return"point"===o&&t.pointColor(t=>t===e?t.hover:t.color),"dotlabel"!==o&&"label"!==o||t.labelColor(t=>t===e?t.hover:t.color),t}function addPointsLayer(t,e){t.pointsData(e.points).pointLat(t=>t.coordinates.latitude).pointLng(t=>t.coordinates.longitude).pointRadius(t=>t.radius/10).pointAltitude(t=>t.altitude/100).pointColor(t=>t.color).pointResolution(20),t.pointLabel((function(t){return setupTooltip(t)})),t.onPointClick((function(o){setupClickEvent(t,e,o)})),t.onPointHover((function(e){setupHoverEvent(t,e,"point")}))}function addLabelsLayer(t,e){if(t.labelsData(e.dotLabels).labelLat(t=>t.coordinates.latitude).labelLng(t=>t.coordinates.longitude).labelText(t=>t.title).labelAltitude(t=>t.altitude/100).labelSize(t=>t.size/10).labelColor(t=>t.color).labelResolution(20).labelIncludeDot(t=>globe_ut_bool(t.includeDot)).labelDotRadius(t=>t.radius/10).labelDotOrientation(t=>t.dotOrientation),e.labelFont&&"default"!==e.labelFont){let o=ittGlobeData.assetsUrl+"fonts/"+e.labelFont+".json";fetch(o).then(t=>t.json()).then(e=>{t.labelTypeFace(e)}).catch(t=>{console.error("Fetch error:",t)})}t.labelLabel((function(t){return setupTooltip(t)})),t.onLabelClick((function(o,n,l){setupClickEvent(t,e,o)})),t.onLabelHover((function(e){setupHoverEvent(t,e,"label")}))}function setupResizeEvent(t,e,o){var n=e.closest(".itt_globe_aspect_ratio");window.addEventListener("resize",(function(){window.innerWidth<=780&&void 0!==o.paddingTop&&""!==o.paddingTop?n.style.paddingTop=String(o.paddingTopMobile)+"%":n.style.paddingTop=String(o.paddingTop)+"%",t.width()!==e.offsetWidth&&t.width(e.offsetWidth).height(e.offsetHeight)}))}function setupInteractions(t,e){void 0!==e.interactions&&(t.controls().enableZoom=globe_ut_bool(e.interactions.zoom),t.controls().enablePan=globe_ut_bool(e.interactions.pan),t.controls().enableRotate=globe_ut_bool(e.interactions.pan))}let ittGlobes={globes:[],globesIndex:{},clickActions:{},init:function(){if("undefined"==typeof Globe)return void console.error("Globe lib not loaded properly");let t=document.getElementsByClassName("js-itt-globe-render");for(const e of t){if(!e.dataset.hasOwnProperty("globe_id"))continue;let t=0;try{t=parseInt(JSON.parse(e.dataset.globe_id))}catch(t){continue}if(void 0!==ittGlobes.globesIndex[t])continue;if(!e.dataset.hasOwnProperty("globe_meta"))continue;let o={};try{o=JSON.parse(e.dataset.globe_meta)}catch(t){o={}}create_globe(t,o)}}};var create_globe=function(t,e){let o=document.getElementById("itt_globe_"+t);globe_ut_prepareData(e),globe_ut_setupData(e,{points:"pointDefaults",dotLabels:"labelDefaults"}),globe_ut_prepareViewport(o,e);let n={rendererConfig:{antialias:!0,alpha:!0},waitForGlobeReady:!0,animateIn:void 0===e.animateIn||globe_ut_bool(e.animateIn)},l=Globe(n)(document.getElementById("itt_globe_"+t));"transparent"===e.backgroundColor&&(e.backgroundColor="rgba(0,0,0,0)"),null!==e.globeImage&&""!==e.globeImage&&"earth-hollow"!==e.globeImage&&"noImage"!==e.globeImage&&"customImage"!==e.globeImage&&l.globeImageUrl(ittGlobeData.imagesUrl+e.globeImage),l.backgroundColor(e.backgroundColor).width(o.offsetWidth).height(o.offsetHeight).showGraticules(globe_ut_bool(e.showGraticules)).showAtmosphere(globe_ut_bool(e.atmosphere.enabled)).atmosphereColor(e.atmosphere.atmosphereColor).atmosphereAltitude(e.atmosphere.atmosphereAltitude).pointOfView(e.pointOfView),setupInteractions(l,e),setupResizeEvent(l,o,e),ittGlobeData.isAdmin&&l.onGlobeReady((function(){const t=new Event("adminGlobeReady");document.dispatchEvent(t)})),e.points&&addPointsLayer(l,e),e.dotLabels&&addLabelsLayer(l,e),ittGlobes.globes.push(l),ittGlobes.globesIndex[t]=l};ittGlobes.init(),window.ittGlobes=ittGlobes;export{ittGlobes};